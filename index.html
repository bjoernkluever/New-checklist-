
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Preparedness & Anticipatory Action Checklist</title>
  <meta name="description" content="A simple checklist that remembers your progress automatically." />

  <!-- Basic, readable styles -->
  <style>
    :root {
      --bg: #f7f7f9;
      --panel: #ffffff;
      --text: #1c1c1c;
      --muted: #6b7280;
      --brand: #2563eb;      /* blue-600 */
      --brand-ink: #0b2c77;
      --border: #e5e7eb;
      --ok: #10b981;         /* emerald-500 */
      --warn: #f59e0b;       /* amber-500 */
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      line-height: 1.5;
    }
    .wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px;
    }
    header {
      margin: 8px 0 24px;
      padding: 20px;
      background: linear-gradient(135deg, #f0f5ff 0%, #ffffff 100%);
      border: 1px solid var(--border);
      border-radius: 12px;
    }
    header h1 {
      margin: 0 0 8px;
      font-size: 1.6rem;
      color: var(--brand-ink);
    }
    header p {
      margin: 0;
      color: var(--muted);
    }
    .controls {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    button, .btn {
      appearance: none;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    button.primary {
      background: var(--brand);
      border-color: var(--brand);
      color: #fff;
    }
    button:hover {
      filter: brightness(0.98);
    }

    .section {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 18px;
      margin: 0 0 16px;
    }
    .section h2 {
      margin: 0 0 12px;
      font-size: 1.25rem;
      color: var(--brand-ink);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .section small {
      color: var(--muted);
      font-weight: 500;
    }

    ul.checklist {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }

    @media (min-width: 680px) {
      ul.checklist { grid-template-columns: 1fr 1fr; }
    }

    .item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      border: 1px dashed var(--border);
      border-radius: 10px;
      padding: 10px;
      background: #fafafa;
    }
    .item label {
      font-weight: 600;
      cursor: pointer;
    }
    .item p {
      margin: 4px 0 0 0;
      color: var(--muted);
      font-size: 0.95rem;
    }
    .tag {
      display: inline-block;
      font-size: 0.78rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: var(--brand-ink);
      border: 1px solid var(--border);
      margin-left: 6px;
    }

    footer {
      color: var(--muted);
      font-size: 0.9rem;
      text-align: center;
      margin: 24px 0 12px;
    }
    .sr-only {
      position: absolute;
      width: 1px; height: 1px;
      padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0);
      border: 0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Preparedness & Anticipatory Action Checklist</h1>
      <p>Tick items as you go—your progress is saved automatically in your browser.</p>
      <div class="controls">
        <button class="primary" type="button" onclick="clearChecklistState()">Reset all checks</button>
        <button type="button" onclick="exportChecklist()">Export progress</button>
        <button type="button" onclick="importChecklist()">Import progress</button>
        <span class="sr-only" id="status" aria-live="polite"></span>
      </div>
    </header>

    <!-- ===== Replace these sample sections with your own content as needed ===== -->

    <section class="section" id="phase-readiness">
      <h2>Phase 1: Readiness <span class="tag">Preparedness</span></h2>
      <ul class="checklist">
        <li class="item">
          <input type="checkbox" id="readiness-risk-monitoring" />
          <div>
            <label for="readiness-risk-monitoring">Risk monitoring in place</label>
            <p>Hazard thresholds and triggers defined for priority contexts.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="readiness-sop-approved" />
          <div>
            <label for="readiness-sop-approved">SOPs approved and socialized</label>
            <p>Activation steps documented and shared across teams.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="readiness-financing-prearranged" />
          <div>
            <label for="readiness-financing-prearranged">Pre-arranged financing in place</label>
            <p>Triggers mapped to funding sources and ceilings.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="readiness-partner-mapping" />
          <div>
            <label for="readiness-partner-mapping">Partner mapping completed</label>
            <p>Operational partners confirmed for priority areas.</p>
          </div>
        </li>
      </ul>
      <small>Tip: IDs on checkboxes (like <code>readiness-risk-monitoring</code>) make saved state resilient.</small>
    </section>

    <section class="section" id="phase-activation">
      <h2>Phase 2: Activation <span class="tag">Anticipatory Action</span></h2>
      <ul class="checklist">
        <li class="item">
          <input type="checkbox" id="activation-trigger-met" />
          <div>
            <label for="activation-trigger-met">Trigger met & validated</label>
            <p>Evidence documented; communications sent to stakeholders.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="activation-targeting-complete" />
          <div>
            <label for="activation-targeting-complete">Targeting lists finalized</label>
            <p>Beneficiary selection criteria applied and lists verified.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="activation-cash-modality-ready" />
          <div>
            <label for="activation-cash-modality-ready">Cash modality ready</label>
            <p>Delivery mechanism confirmed; KYC and compliance addressed.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="activation-m-e-plan" />
          <div>
            <label for="activation-m-e-plan">M&E plan initiated</label>
            <p>Outcome indicators and timelines agreed.</p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="phase-review">
      <h2>Phase 3: Review & Learning <span class="tag">After Action</span></h2>
      <ul class="checklist">
        <li class="item">
          <input type="checkbox" id="review-post-distribution" />
          <div>
            <label for="review-post-distribution">Post-distribution monitoring</label>
            <p>Rapid PDM completed within agreed window.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="review-lessons-learned" />
          <div>
            <label for="review-lessons-learned">Lessons learned documented</label>
            <p>Key insights captured; actions assigned.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="review-sop-updated" />
          <div>
            <label for="review-sop-updated">SOPs updated</label>
            <p>Procedures refined based on evidence and feedback.</p>
          </div>
        </li>
        <li class="item">
          <input type="checkbox" id="review-briefing-completed" />
          <div>
            <label for="review-briefing-completed">Briefing to leadership</label>
            <p>Outcomes and recommendations shared with leadership.</p>
          </div>
        </li>
      </ul>
    </section>

    <footer>
      <p>Progress is stored locally in your browser and stays after closing the page. It won’t sync across devices.</p>
    </footer>
  </div>

  <!-- ===== Persistence Script (auto-save + restore + import/export) ===== -->
  <script>
    (function () {
      // Unique storage key per page path, so different pages don't clash.
      const STORAGE_KEY = `checklist-state::${location.pathname}`;

      // Scope persistence to all checkboxes on the page
      const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]'));

      // Build a stable identifier for each checkbox
      function getCheckboxId(cb, index) {
        if (cb.id) return cb.id;
        if (cb.name) return `name:${cb.name}[${index}]`;
        // Fallback: minimal DOM path
        let path = [];
        let el = cb;
        while (el && el !== document.body) {
          const tag = el.tagName.toLowerCase();
          const idx = Array.from(el.parentNode ? el.parentNode.children : []).indexOf(el);
          path.push(`${tag}:${idx}`);
          el = el.parentElement;
        }
        return `path:${path.reverse().join('/')}`;
      }

      function restoreState() {
        try {
          const saved = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
          checkboxes.forEach((cb, i) => {
            const id = getCheckboxId(cb, i);
            if (Object.prototype.hasOwnProperty.call(saved, id)) {
              cb.checked = !!saved[id];
            }
          });
          announce('Progress restored.');
        } catch (e) {
          console.warn('Checklist: restore failed', e);
          announce('Restore failed.');
        }
      }

      function saveState() {
        try {
          const state = {};
          checkboxes.forEach((cb, i) => {
            const id = getCheckboxId(cb, i);
            state[id] = cb.checked;
          });
          localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
          // announce('Progress saved.'); // keep quiet to avoid chatter
        } catch (e) {
          console.warn('Checklist: save failed', e);
          announce('Save failed.');
        }
      }

      // Debounce save to avoid excessive writes
      let saveTimer = null;
      function scheduleSave() {
        clearTimeout(saveTimer);
        saveTimer = setTimeout(saveState, 150);
      }

      // Accessibility status updates
      function announce(msg) {
        const status = document.getElementById('status');
        if (status) status.textContent = msg;
      }

      // Wire events
      checkboxes.forEach(cb => cb.addEventListener('change', scheduleSave));
      window.addEventListener('beforeunload', saveState);

      // Public helpers
      window.clearChecklistState = function () {
        localStorage.removeItem(STORAGE_KEY);
        checkboxes.forEach(cb => (cb.checked = false));
        announce('Progress cleared.');
      };

      window.exportChecklist = function () {
        try {
          const data = localStorage.getItem(STORAGE_KEY) || '{}';
          const blob = new Blob([data], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'checklist-progress.json';
          document.body.appendChild(a);
          a.click();
          a.remove();
          URL.revokeObjectURL(url);
          announce('Progress exported.');
        } catch (e) {
          console.warn('Checklist: export failed', e);
          announce('Export failed.');
        }
      };

      window.importChecklist = function () {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'application/json';
        input.addEventListener('change', (ev) => {
          const file = ev.target.files && ev.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const obj = JSON.parse(reader.result);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
              restoreState();
              announce('Progress imported.');
            } catch (e) {
              console.warn('Checklist: import failed', e);
              announce('Import failed.');
            }
          };
          reader.readAsText(file);
        });
        input.click();
      };

      // Kick off
      restoreState();
    })();
  </script>
</body>
</html>
